package rohin.gameengine;

public class ECSSystemCommandManager extends ECSSystem
{
    // Fields.
    
    Boolean       loggingEnabled;
    ConsoleLogger logger;
    
    // --------------------------------------------------------------------------------------------------------------------------------------------------------
    // Constructor/s
    // --------------------------------------------------------------------------------------------------------------------------------------------------------
    
    public ECSSystemCommandManager( ECSEngine owner )
    {
        // Initialize ECS object parameters.
        
        this.id    = Constants.SYSTEM_COMMAND_MANAGER;
        this.name  = "SYSTEM_COMMAND_MANAGER";
        this.text  = "Command Manager";
        this.owner = owner;
        
        // Initialize system management parameters.
        
        this.loggingEnabled = true;
        this.logger         = new ConsoleLogger ( this, this.loggingEnabled );
    }
    
    // --------------------------------------------------------------------------------------------------------------------------------------------------------
    // Override implementation of ECSSystem.Update. 
    // --------------------------------------------------------------------------------------------------------------------------------------------------------
    
    public void Update ( long t, ECSEngine engine )
    {   
        // Constants.
        //
        // Note: Component index constants, must be specified in the order in which they will be passed to ECSEntity.GetComponents as arguments.
        
        final int INDEX_COMMAND_INVOKER = 0;    // Component array index.
        
        // Components.
        
        ECSComponentCommandInvoker componentCommandInvoker = new ECSComponentCommandInvoker ();
        
        // Call the command invocation component on the command queue entity.
        
        ECSEntity entity        = engine.GetEntities ().get ( Constants.ENTITY_COMMAND_QUEUE );                 // Get the command queue entity.        
        componentCommandInvoker = ( ECSComponentCommandInvoker ) entity.GetComponent ( INDEX_COMMAND_INVOKER ); // Get the command invoker component.
                
        // Flush the command invoker. (Execute all commands).
        
        componentCommandInvoker.commandInvoker.Flush ();
        
        // Console logger.
                
        logger.Log ();        
    }
}



